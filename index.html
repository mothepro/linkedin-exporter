<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta     http-equiv="X-UA-Compatible"
    content="IE=edge"
  >
  <meta     name="viewport"
    content="width=device-width, initial-scale=1.0, shrink-to-fit=no"
  >
  <title>LinkedIn Sales Navigator Exporter</title>
  <link     rel="stylesheet"
    href="https://unpkg.com/@picocss/pico@latest/css/pico.classless.min.css"
  >
</head>

<body>
  <main class="container">
    <h1>LinkedIn Sales Navigator Exporter</h1>
    <article>
      Drag <a role="button" bookmarklet href="javascript:(function(){%22use%20strict%22;function%20t(t,e=%22Assertion%20Error%22)%7Bif(!t)throw%20new%20Error(e)%7Dfunction%20e(e,d)%7Breturn%20t(null!=e,d),e%7Dconst%20d=t=%3E%60%22$%7Bt.replace(/(%5Cr%5Cn%7C%5Cn%7C%5Cr%7C%5Cs+%7C%5Ct%7C&nbsp;)/gm,%22%20%22).replace(/%22/g,'%22%22').trim()%7D%22%60;function%20i(d)%7Bvar%20i;const%20n=new%20Map;let%20o=0;for(;;)try%7Bo++;for(const%5Ba,r%5Dof%20Object.entries(d))%7Bconst%20d=document.evaluate(r(o),document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null);let%20v=%22%22;try%7Bconst%20t=e(d.singleNodeValue,%60Unable%20to%20find%20element%20for%20the%20$%7Bo%7Dth%20$%7Ba%7D%20field.%60);v=%22Link%22===a?t.href:e(t.textContent,%60No%20text%20found%20in%20the%20$%7Bo%7Dth%20$%7Ba%7D%20field.%60)%7Dcatch(e)%7Bt(e%20instanceof%20Error),t(%22Account%22===a,e.message)%7Dn.set(a,%5B...null!==(i=n.get(a))&&void%200!==i?i:%5B%5D,v%5D)%7D%7Dcatch(t)%7Bconsole.error(t);break%7Dreturn%20n%7Dconst%20n=%7BName:t=%3E%60/html/body/main/div%5B1%5D/div%5B2%5D/div%5B4%5D/table/tbody/tr%5B$%7Bt%7D%5D/td%5B1%5D/div/figure/a/span%60,Link:t=%3E%60/html/body/main/div%5B1%5D/div%5B2%5D/div%5B4%5D/table/tbody/tr%5B$%7Bt%7D%5D/td%5B1%5D/div/figure/a%60,Geography:t=%3E%60/html/body/main/div%5B1%5D/div%5B2%5D/div%5B4%5D/table/tbody/tr%5B$%7Bt%7D%5D/td%5B3%5D%60,Title:t=%3E%60/html/body/main/div%5B1%5D/div%5B2%5D/div%5B4%5D/table/tbody/tr%5B$%7Bt%7D%5D/td%5B1%5D/div/div%5B2%5D/div%5B2%5D/span/div%60,Account:t=%3E%60/html/body/main/div%5B1%5D/div%5B2%5D/div%5B4%5D/table/tbody/tr%5B$%7Bt%7D%5D/td%5B2%5D/div/div/div/a/div/div/div/span%60%7D,o=%7BName:t=%3E%60/html/body/main/div%5B1%5D/div%5B2%5D/div%5B5%5D/table/tbody/tr%5B$%7Bt%7D%5D/td%5B1%5D/div/div%5B2%5D/div%5B1%5D/div%5B1%5D/a%60,Link:t=%3E%60/html/body/main/div%5B1%5D/div%5B2%5D/div%5B5%5D/table/tbody/tr%5B$%7Bt%7D%5D/td%5B1%5D/div/div%5B2%5D/div%5B1%5D/div%5B1%5D/a%60,Geography:t=%3E%60/html/body/main/div%5B1%5D/div%5B2%5D/div%5B5%5D/table/tbody/tr%5B$%7Bt%7D%5D/td%5B3%5D%60,Title:t=%3E%60/html/body/main/div%5B1%5D/div%5B2%5D/div%5B5%5D/table/tbody/tr%5B$%7Bt%7D%5D/td%5B1%5D/div/div%5B2%5D/div%5B2%5D/span/div%60,Account:t=%3E%60/html/body/main/div%5B1%5D/div%5B2%5D/div%5B5%5D/table/tbody/tr%5B$%7Bt%7D%5D/td%5B2%5D/div/div/div/a/div/div/div/span%60%7D;try%7Bconst%20e=(new%20Date).toLocaleDateString(void%200,%7Bweekday:%22long%22,year:%22numeric%22,month:%22short%22,day:%22numeric%22%7D);console.log(%22searching%20user-generated%20xpaths%22);let%20a=i(n);a.size%7C%7C(console.warn(%22Unable%20to%20find%20user%20generated%20paths%22),console.log(%22searching%20system-generated%20xpaths%22),a=i(o)),t(a.size,%22No%20data%20was%20found%20to%20export%22),function(t,e,d=%7Btype:%22text/csv%22%7D)%7Bconst%20i=document.createElement(%22a%22);i.setAttribute(%22href%22,URL.createObjectURL(new%20Blob(%5Be%5D,d))),i.setAttribute(%22download%22,t),i.style.display=%22none%22,document.body.appendChild(i),i.click()%7D(%60Contacts%20Exported%20on%20$%7Be%7D.csv%60,function(t)%7Bconst%20e=%5B%5B...t.keys()%5D%5D;for(let%20d=0;d%3CMath.max(...%5B...t.values()%5D.map((t=%3Et.length)));d++)%7Bconst%20i=%5B%5D;for(const%20n%20of%20e%5B0%5D)%7Bconst%20e=t.get(n);i.push(e%5Bd%5D)%7De.push(i)%7Dreturn%20e.map((t=%3Et.map(d).join(%22,%22))).join(%22%5Cn%22)%7D(a))%7Dcatch(e)%7Bt(e%20instanceof%20Error),alert(e.message)%7D})();">Export Contacts</a> to your bookmarks
    </article>
    <video autoplay muted loop controls style="max-width: 100%">
      <source type="video/mp4" src="howto.MP4">
    </video>
  </main>
  <footer>
    Made with &hearts; by <a href="https://brazetechnology.slack.com/archives/D02PGE8LJ3G">Mo</a> <span build-time="1674082461255">Wed Jan 18 2023 16:54:21 GMT-0600 (Central Standard Time)</span>
  </footer>
</body>

<script>
  // TODO use the `new Intl.RelativeTimeFormat(undefined, { style: 'narrow' })`
  function timeAgo(prevDate) {
    const diff = Date.now() - prevDate
    const minute = 60 * 1000
    const hour = minute * 60
    const day = hour * 24
    const month = day * 30
    const year = day * 365
    switch (true) {
      case diff < minute:
        const seconds = Math.round(diff / 1000)
        return `${seconds} ${seconds > 1 ? 'seconds' : 'second'} ago`
      case diff < hour:
        return Math.round(diff / minute) + ' minutes ago'
      case diff < day:
        return Math.round(diff / hour) + ' hours ago'
      case diff < month:
        return Math.round(diff / day) + ' days ago'
      case diff < year:
        return Math.round(diff / month) + ' months ago'
      case diff > year:
        return Math.round(diff / year) + ' years ago'
      default:
        return ""
    }
  };

  const
    element = document.querySelector('[build-time]'),
    buildTime = element.getAttribute('build-time'),
    date = new Date(parseInt(buildTime))
  element.innerHTML = timeAgo(+date)
  element.title = date.toString()
</script>

</html>

